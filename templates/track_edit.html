{% extends "layout.html" %}

{% block title %}
    Edit {{title}}
{% endblock %}

{% block main %}
    <form action="/track_edit" method="post">
      <div class="button-container">
        <input class="edit_buttons_top" type ="submit" name="left"     value = "Left curve &ShortLeftArrow; ({{ lib.curve }} / {{ lib.n_curves }})">
        <input class="edit_buttons_top" type ="submit" name="straight" value = "Straight &ShortUpArrow;  ({{ lib.straight }} / {{ lib.n_straights }})">
        <input class="edit_buttons_top" type ="submit" name="right"    value = "Right curve &ShortRightArrow;  ({{ lib.curve }} / {{ lib.n_curves }})">
        <input class="edit_buttons_top" type ="submit" name="switch"   value = "Switch  ({{ lib.switch }} / {{ lib.n_switches }})">
        <input class="edit_buttons_top" type ="submit" name="crossing"   value = "Crossing  ({{ lib.crossing }} / {{ lib.n_crossings }})">
      </div>
      <div class="button-container">
        <input class="edit_buttons_bottom" type ="submit" name="rotate"      value = "Rotate piece &circlearrowright;">
        <input class="edit_buttons_bottom" type ="submit" name="next_ending" value = "Next ending &#x23E9;">
        <input class="edit_buttons_bottom" type ="submit" name="save"     value = "Save &#128190;">
        <input class="edit_buttons_bottom" type ="submit" name="delete"   value = "Delete &#10060;">
      </div>
    </form>

    <br>
    <canvas id="drawingCanvas" width="500" height="500"></canvas>
    <script>
        function drawElement(el) {
            const canvas = document.getElementById('drawingCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.beginPath();
            for (let i = 0; i < el.length; i++) {
              // HTML canvas is inverted
              ctx.lineTo(el[i].x, 500 - el[i].y);
            }
            ctx.closePath();             

            ctx.stroke();
        }

        // Draw the Circle       
        {% for el in path %}
        drawElement({{el | tojson}});
        {% endfor %}
    </script>
{% endblock %}